# config.yaml

gemm:
  sizes: [128, 256, 512, 1024]
  kappas: [1e2, 1e3, 1e4, 1e5, 1e6]
  formats: [fp32, tf32, bfloat16, fp8]
  accum_modes: [fp32, small]   # produces "-fp32" and "-small"

cg:
  m_values: [64, 128]
  formats: [fp32, tf32, bfloat16, fp8]
  accum_modes: [small, fp32]
  max_iters: 1000
  # sensible defaults if per_format is not provided
  warmup_small: 0
  restart_every: 0
  per_format:
    fp32:
      tol: 1.0e-6
      warmup_small: 0
      restart_every: 0
    tf32:
      tol: 1.0e-3
      warmup_small: 20
      restart_every: 40
    bfloat16:
      tol: 5.0e-3
      warmup_small: 10
      restart_every: 25
    fp8:
      tol: 2.0e-1
      warmup_small: 10
      restart_every: 20

newton:
  functions: [sinx_minus_x2, x3_minus_7]
  starts: [-3, -1, 0.1, 1, 3]
  formats: [fp32, tf32, bfloat16, fp8]
  accum_modes: [small, fp32]
  max_iters: 100
  per_format:
    fp32:     { tol: 1.0e-6 }
    tf32:     { tol: 1.0e-3 }
    bfloat16: { tol: 5.0e-3 }
    fp8:      { tol: 2.0e-1 }
